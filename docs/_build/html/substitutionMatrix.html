
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>Subtitution Matrix &#8212; jMSA 1.0-SNAPSHOT documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Utils" href="utils.html" />
    <link rel="prev" title="Scores" href="scores.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="subtitution-matrix">
<h1>Subtitution Matrix<a class="headerlink" href="#subtitution-matrix" title="Permalink to this headline">¶</a></h1>
<div class="section" id="theoric-base">
<h2>Theoric base.<a class="headerlink" href="#theoric-base" title="Permalink to this headline">¶</a></h2>
<p>Substitution matrices show the probability of an amino accid mutating or being substituted by
another one. The simplest matrix  would be the ‘match/mismatch’ one, which asigns a positive value
to the positions where both sequences concur adn a negative value when they don’t.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Substitution matrices are used to score alignements between sequences, i. e., to see the similarity
degree between them. The higher the score, the better, and the alignment with the highest score
between all possible alignements is called “optimun alignment”.</p>
</div>
<div class="section" id="pam">
<h3>PAM<a class="headerlink" href="#pam" title="Permalink to this headline">¶</a></h3>
<p>The PAM matrix (Point accepted mutation) represents the substitution, on average, of 1% of amino acids
of another.</p>
<img alt="_images/PAM250.PNG" src="_images/PAM250.PNG" />
<p>PAM250, the one we’re using, is optimized for alignments with approxi-mately 20% identical residues.</p>
</div>
<div class="section" id="blossum">
<h3>Blossum<a class="headerlink" href="#blossum" title="Permalink to this headline">¶</a></h3>
<p>The Blossum matrix (Block-sum) uses a more direct approach when estimating target frequencies
Said ‘blocks’ consist of aligned protein segments that are relatively well-conserved across whole
protein families.</p>
<img alt="_images/Blossum62.PNG" src="_images/Blossum62.PNG" />
<p>The BLOSUM-62 matrix (which corresponds roughly toPAM-180 and is the one whe will be using) is derived
by ﬁrst clustering all segments that are more than 62% identical.</p>
</div>
</div>
<div class="section" id="class-structure">
<h2>Class structure.<a class="headerlink" href="#class-structure" title="Permalink to this headline">¶</a></h2>
<p>Blossum62 and PAM250 classes implement the SubstitutionMatix interface.</p>
<p>These classes have two constructors , one without parameters and other with the desired gap score as
parameter. We also have a matrixReader method, which reads the matrix from a file, a method called
getDistance, which, given to characters, returns the distance in the matrix between them, and the
methods getGapCharacter and getGapPenalty.</p>
<p>The matrixReader method relies on the class SubstitutionMatrixReader:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Character</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">Integer</span><span class="o">&gt;</span> <span class="nf">readMatrixFromFile</span><span class="p">(</span><span class="n">String</span> <span class="n">file</span><span class="p">,</span> <span class="n">SubstitutionMatrix</span> <span class="n">substitutionMatrix</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Character</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">Integer</span><span class="o">&gt;</span> <span class="n">NewSubstitutionMatrix</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;</span><span class="p">();</span>
    <span class="n">String</span> <span class="n">line</span><span class="p">;</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">guide</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Character</span><span class="o">&gt;</span> <span class="n">key1</span><span class="p">;</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Character</span><span class="o">&gt;</span> <span class="n">key2</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">value</span><span class="p">;</span>

    <span class="k">try</span> <span class="p">(</span><span class="n">BufferedReader</span> <span class="n">fileReader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="p">(</span><span class="k">new</span> <span class="n">FileReader</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="na">valueOf</span><span class="p">(</span><span class="n">Paths</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">file</span><span class="p">)))))</span> <span class="p">{</span>
        <span class="k">while</span> <span class="p">((</span><span class="n">line</span> <span class="o">=</span> <span class="n">fileReader</span><span class="p">.</span><span class="na">readLine</span><span class="p">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">//The first nine lines start by # -&gt; they don&#39;t contain substitutionMatrix distances</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">line</span><span class="p">.</span><span class="na">startsWith</span><span class="p">(</span><span class="s">&quot;#&quot;</span><span class="p">))</span> <span class="p">{</span>
                <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">lineMatrix</span> <span class="o">=</span> <span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span><span class="n">line</span><span class="p">.</span><span class="na">trim</span><span class="p">().</span><span class="na">split</span><span class="p">(</span><span class="s">&quot;\\s+&quot;</span><span class="p">));</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">line</span><span class="p">.</span><span class="na">startsWith</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">))</span> <span class="p">{</span>
                    <span class="c1">//The first line, with amino acids values -&gt; this is the guide to compare with aas in rest of lines</span>
                    <span class="n">guide</span> <span class="o">=</span> <span class="n">lineMatrix</span><span class="p">;</span>
                <span class="p">}</span> <span class="k">else</span> <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">Objects</span><span class="p">.</span><span class="na">requireNonNull</span><span class="p">(</span><span class="n">guide</span><span class="p">).</span><span class="na">size</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                    <span class="c1">//Two keys to get the aas in both ways</span>
                    <span class="n">key1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>
                    <span class="n">key2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>

                    <span class="n">key1</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">lineMatrix</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="na">charAt</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
                    <span class="n">key1</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">guide</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="na">charAt</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>

                    <span class="n">key2</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">guide</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="na">charAt</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
                    <span class="n">key2</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">lineMatrix</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="na">charAt</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>

                    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">NewSubstitutionMatrix</span><span class="p">.</span><span class="na">containsKey</span><span class="p">(</span><span class="n">key1</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">NewSubstitutionMatrix</span><span class="p">.</span><span class="na">containsKey</span><span class="p">(</span><span class="n">key2</span><span class="p">))</span> <span class="p">{</span>
                        <span class="c1">//For determinate gapPenalty -&gt; we check if gapPenalty value has been initialized</span>
                        <span class="k">if</span> <span class="p">((</span><span class="n">key1</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="na">equals</span><span class="p">(</span><span class="n">substitutionMatrix</span><span class="p">.</span><span class="na">getGapCharacter</span><span class="p">())</span> <span class="o">^</span> <span class="n">key1</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="na">equals</span><span class="p">(</span><span class="n">substitutionMatrix</span><span class="p">.</span><span class="na">getGapCharacter</span><span class="p">()))</span> <span class="o">&amp;&amp;</span>
                                <span class="p">(</span><span class="n">substitutionMatrix</span><span class="p">.</span><span class="na">getInitialGapPenalty</span><span class="p">()</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">))</span> <span class="p">{</span>
                            <span class="c1">//It changes gapPenalty value in matrix</span>
                            <span class="n">value</span> <span class="o">=</span> <span class="n">substitutionMatrix</span><span class="p">.</span><span class="na">getInitialGapPenalty</span><span class="p">().</span><span class="na">intValue</span><span class="p">();</span>
                        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                            <span class="c1">//It takes gapPenalty value from substitutionMatrix file (default gapPenalty)</span>
                            <span class="n">value</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">.</span><span class="na">parseInt</span><span class="p">(</span><span class="n">lineMatrix</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">));</span>
                            <span class="k">if</span> <span class="p">((</span><span class="n">key1</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="na">equals</span><span class="p">(</span><span class="n">substitutionMatrix</span><span class="p">.</span><span class="na">getGapCharacter</span><span class="p">())</span> <span class="o">^</span> <span class="n">key1</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="na">equals</span><span class="p">(</span><span class="n">substitutionMatrix</span><span class="p">.</span><span class="na">getGapCharacter</span><span class="p">()))){</span>
                                <span class="n">substitutionMatrix</span><span class="p">.</span><span class="na">setGapPenalty</span><span class="p">(</span><span class="n">Double</span><span class="p">.</span><span class="na">valueOf</span><span class="p">(</span><span class="n">value</span><span class="p">));</span>
                            <span class="p">}</span>
                        <span class="p">}</span>

                        <span class="n">NewSubstitutionMatrix</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">key1</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="c1">//Exception control</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">FileNotFoundException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;File not found&quot;</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">IOException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;An IO error has occured: &quot;</span> <span class="o">+</span> <span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
        <span class="n">System</span><span class="p">.</span><span class="na">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">NewSubstitutionMatrix</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The getDistance method.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kt">double</span> <span class="nf">getDistance</span><span class="p">(</span><span class="kt">char</span> <span class="n">char1</span><span class="p">,</span> <span class="kt">char</span> <span class="n">char2</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Character</span><span class="o">&gt;</span> <span class="n">pair</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>
    <span class="n">pair</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">char1</span><span class="p">);</span>
    <span class="n">pair</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">char2</span><span class="p">);</span>
    <span class="kt">double</span> <span class="n">distance</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">subsMatrix</span><span class="p">.</span><span class="na">containsKey</span><span class="p">(</span><span class="n">pair</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">Collections</span><span class="p">.</span><span class="na">reverse</span><span class="p">(</span><span class="n">pair</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">distance</span> <span class="o">=</span> <span class="n">Double</span><span class="p">.</span><span class="na">valueOf</span><span class="p">(</span><span class="n">subsMatrix</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">pair</span><span class="p">));</span>
    <span class="k">return</span> <span class="n">distance</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">jMSA</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Index:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="problem.html">Multiple sequence alignment</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="alignment_tools.html">Tools for multiple sequence alignment</a></li>
<li class="toctree-l1"><a class="reference internal" href="how_to_score.html">How to score a MSA</a></li>
<li class="toctree-l1"><a class="reference internal" href="scores.html">Scores</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Subtitution Matrix</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#theoric-base">Theoric base.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#class-structure">Class structure.</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="scores.html" title="previous chapter">Scores</a></li>
      <li>Next: <a href="utils.html" title="next chapter">Utils</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, PAB2020.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.0.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/substitutionMatrix.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>